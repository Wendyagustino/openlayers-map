<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Dashboard Admin | GREENPKU</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="halaman.css"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script>
        // Proteksi Halaman Admin
        if (localStorage.getItem('admin_logged_in') !== 'true') {
            window.location.href = "login.html";
        }
    </script>
</head>
<body class="admin-page">

    <aside class="admin-sidebar">
        <div class="admin-profile">
            <div class="avatar-placeholder"><i class="fas fa-user-shield"></i></div>
            <h3 id="admin-name">Admin</h3>
        </div>
        <nav class="admin-menu">
            <a href="dashboard.php" class="active"><i class="fas fa-home"></i> Dashboard</a>
            <a href="list.php"><i class="fas fa-database"></i> Dataset</a>
        </nav>
        <div class="logout-section">
            <a href="#" id="logout-btn" class="logout-link"><i class="fas fa-sign-out-alt"></i> Logout</a>
        </div>
    </aside>

    <main class="main-content">
        <div class="breadcrumb">Home / <b>Dashboard</b></div>
        
        <h2 class="section-title">Statistik RTH Kota Pekanbaru</h2>

        <div class="green-panel">
            <section class="dashboard-cards">
                <div class="card">
                    <div class="card-icon">
                        <i class="fas fa-tree"></i>
                    </div>
                    <div class="card-info">
                        <span class="card-label">Total RTH</span>
                        <h2 class="card-number" id="total-rth">0</h2>
                    </div>
                </div>

                <div class="card">
                    <div class="card-icon">
                        <i class="fas fa-leaf"></i>
                    </div>
                    <div class="card-info">
                        <span class="card-label">Taman Kota</span>
                        <h2 class="card-number" id="taman-kota">0</h2>
                    </div>
                </div>

                <div class="card">
                    <div class="card-icon">
                        <i class="fas fa-road"></i>
                    </div>
                    <div class="card-info">
                        <span class="card-label">Jalur Hijau</span>
                        <h2 class="card-number" id="jalur-hijau">0</h2>
                    </div>
                </div>
            </section>
        </div>

        <section class="dashboard-map">
            <h3>Visualisasi Peta Admin</h3>
            <div class="map-container">
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d127660.10170044548!2d101.372551460592!3d0.5104470217088902!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x31d5ac0944f24c9d%3A0x3039d80b220cc30!2sPekanbaru%2C%20Kota%20Pekanbaru%2C%20Riau!5e0!3m2!1sid!2sid!4v1700000000000!5m2!1sid!2sid" 
                width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
            </div>
        </section>
    </main>

    <script type="module">
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
        const supabase = createClient('URL_SUPABASE_ANDA', 'KEY_SUPABASE_ANDA');

        // Update Statistik secara Real-time dari Supabase
        async function updateStats() {
            const { count, error } = await supabase
                .from('Data_RTH')
                .select('*', { count: 'exact', head: true });
            if (!error) document.getElementById('total-rth').innerText = count;
        }

        document.getElementById('admin-name').innerText = localStorage.getItem('nama_admin') || 'Admin';
        document.getElementById('logout-btn').onclick = () => {
            localStorage.clear();
            window.location.href = "../login.html";
        };
        updateStats();
    </script>
</body>
</html>